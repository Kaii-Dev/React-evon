{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport axios from 'axios';\nimport React, { useEffect, useRef, useState } from 'react';\n\nconst useHackerNewsAPI = () => {\n  _s();\n\n  const [hits, setHits] = useState([]);\n  const [query, setQuery] = useState(\"\");\n  const handleFetchData = useRef({}); //useRef luu cac gia tri ben ngoai compo, o truong hop nay la query\n\n  const [loading, setLoading] = useState(true);\n  const [url, setUrl] = useState(`https://hn.algolia.com/api/v1/search?query=${query}`); //useREf for hackerNEw\n\n  const isMounted = useRef(true);\n  useEffect(() => {\n    //\n    return () => {\n      isMounted.current = false; //khi compo bị unmount thì sẽ là giá trị false\n    };\n  }, []);\n\n  handleFetchData.current = async () => {\n    setLoading(true);\n\n    try {\n      const response = await axios.get(url); // console.table(response.data.hits);\n\n      if (isMounted) {\n        setTimeout(() => {\n          var _response$data;\n\n          setHits(((_response$data = response.data) === null || _response$data === void 0 ? void 0 : _response$data.hits) || []);\n          setLoading(false);\n        }, 3000);\n      }\n    } catch {\n      setLoading(true);\n      throw new Error(\"something happened with api\");\n    }\n  };\n\n  useEffect(() => {\n    handleFetchData.current();\n  }, [url]); // const handleUpdateQuery = lodash.debounce((e) => {\n  //   setQuery(e.target.value);\n  // }, 500);\n\n  return {\n    query,\n    setQuery,\n    setUrl,\n    loading,\n    hits\n  };\n};\n\n_s(useHackerNewsAPI, \"3/7WnBCayo3IWYZfr4xb2Tfgg/g=\");\n\nexport default useHackerNewsAPI;","map":{"version":3,"sources":["/Users/khai/Library/Mobile Documents/com~apple~CloudDocs/Desktop/WORKSPACE/REACT-BIG/React-evon/my-app/src/hooks/useHackerNewsAPI.js"],"names":["axios","React","useEffect","useRef","useState","useHackerNewsAPI","hits","setHits","query","setQuery","handleFetchData","loading","setLoading","url","setUrl","isMounted","current","response","get","setTimeout","data","Error"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,IAAgBC,SAAhB,EAA2BC,MAA3B,EAAmCC,QAAnC,QAAmD,OAAnD;;AAEA,MAAMC,gBAAgB,GAAG,MAAM;AAAA;;AAC5B,QAAM,CAACC,IAAD,EAAOC,OAAP,IAAkBH,QAAQ,CAAC,EAAD,CAAhC;AACD,QAAM,CAACI,KAAD,EAAQC,QAAR,IAAoBL,QAAQ,CAAC,EAAD,CAAlC;AACA,QAAMM,eAAe,GAAGP,MAAM,CAAC,EAAD,CAA9B,CAH6B,CAGO;;AACpC,QAAM,CAACQ,OAAD,EAAUC,UAAV,IAAwBR,QAAQ,CAAC,IAAD,CAAtC;AACA,QAAM,CAACS,GAAD,EAAMC,MAAN,IAAgBV,QAAQ,CAC3B,8CAA6CI,KAAM,EADxB,CAA9B,CAL6B,CAQ7B;;AACA,QAAMO,SAAS,GAAGZ,MAAM,CAAC,IAAD,CAAxB;AAEAD,EAAAA,SAAS,CAAC,MAAM;AACd;AACA,WAAO,MAAM;AACXa,MAAAA,SAAS,CAACC,OAAV,GAAoB,KAApB,CADW,CACgB;AAC5B,KAFD;AAGD,GALQ,EAKN,EALM,CAAT;;AAOAN,EAAAA,eAAe,CAACM,OAAhB,GAA0B,YAAY;AACpCJ,IAAAA,UAAU,CAAC,IAAD,CAAV;;AACA,QAAI;AACF,YAAMK,QAAQ,GAAG,MAAMjB,KAAK,CAACkB,GAAN,CAAUL,GAAV,CAAvB,CADE,CAEF;;AAEA,UAAIE,SAAJ,EAAe;AACbI,QAAAA,UAAU,CAAC,MAAM;AAAA;;AACfZ,UAAAA,OAAO,CAAC,mBAAAU,QAAQ,CAACG,IAAT,kEAAed,IAAf,KAAuB,EAAxB,CAAP;AACAM,UAAAA,UAAU,CAAC,KAAD,CAAV;AACD,SAHS,EAGP,IAHO,CAAV;AAID;AACF,KAVD,CAUE,MAAM;AACNA,MAAAA,UAAU,CAAC,IAAD,CAAV;AACA,YAAM,IAAIS,KAAJ,CAAU,6BAAV,CAAN;AACD;AACF,GAhBD;;AAkBAnB,EAAAA,SAAS,CAAC,MAAM;AACdQ,IAAAA,eAAe,CAACM,OAAhB;AACD,GAFQ,EAEN,CAACH,GAAD,CAFM,CAAT,CApC6B,CAwC7B;AACA;AACA;;AAEC,SAAO;AACJL,IAAAA,KADI;AAEJC,IAAAA,QAFI;AAGJK,IAAAA,MAHI;AAIJH,IAAAA,OAJI;AAKJL,IAAAA;AALI,GAAP;AAOF,CAnDD;;GAAMD,gB;;AAqDN,eAAeA,gBAAf","sourcesContent":["import axios from 'axios';\nimport React, { useEffect, useRef, useState } from 'react';\n\nconst useHackerNewsAPI = () => {\n   const [hits, setHits] = useState([]);\n  const [query, setQuery] = useState(\"\");\n  const handleFetchData = useRef({}); //useRef luu cac gia tri ben ngoai compo, o truong hop nay la query\n  const [loading, setLoading] = useState(true);\n  const [url, setUrl] = useState(\n    `https://hn.algolia.com/api/v1/search?query=${query}`\n  );\n  //useREf for hackerNEw\n  const isMounted = useRef(true);\n\n  useEffect(() => {\n    //\n    return () => {\n      isMounted.current = false; //khi compo bị unmount thì sẽ là giá trị false\n    };\n  }, []);\n\n  handleFetchData.current = async () => {\n    setLoading(true);\n    try {\n      const response = await axios.get(url);\n      // console.table(response.data.hits);\n\n      if (isMounted) {\n        setTimeout(() => {\n          setHits(response.data?.hits || []);\n          setLoading(false);\n        }, 3000);\n      }\n    } catch {\n      setLoading(true);\n      throw new Error(\"something happened with api\");\n    }\n  };\n\n  useEffect(() => {\n    handleFetchData.current();\n  }, [url]);\n\n  // const handleUpdateQuery = lodash.debounce((e) => {\n  //   setQuery(e.target.value);\n  // }, 500);\n \n   return {\n      query,\n      setQuery,\n      setUrl,\n      loading,\n      hits,\n   }\n};\n\nexport default useHackerNewsAPI;"]},"metadata":{},"sourceType":"module"}